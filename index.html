<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Keshava Jewellers - Employee Login</title>

<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap');

body {
  font-family: "Poppins", sans-serif;
  margin: 0;
  height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  background: radial-gradient(circle at top left, #f9d976, #f39f86);
  background-size: cover;
  overflow: hidden;
}

/* Animated shimmer background */
body::before {
  content: "";
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: url('https://www.transparenttextures.com/patterns/gold-scale.png');
  opacity: 0.2;
  animation: shimmer 12s linear infinite;
}
@keyframes shimmer {
  from { background-position: 0 0; }
  to { background-position: 1000px 1000px; }
}

/* Glass card */
.login-container {
  position: relative;
  z-index: 2;
  background: rgba(255, 255, 255, 0.2);
  backdrop-filter: blur(15px);
  border-radius: 20px;
  padding: 40px 30px;
  width: 350px;
  text-align: center;
  color: #3b3b3b;
  box-shadow: 0 4px 25px rgba(0,0,0,0.3);
  animation: fadeIn 1s ease-in;
}
@keyframes fadeIn {
  from {opacity: 0; transform: translateY(20px);}
  to {opacity: 1; transform: translateY(0);}
}

.logo img {
  width: 90px;
  height: auto;
  margin-bottom: 10px;
}

h2 {
  color: #2e2e2e;
  margin-bottom: 20px;
  font-weight: 600;
  font-size: 1.4em;
}

input {
  width: 100%;
  padding: 12px;
  margin-bottom: 15px;
  border: none;
  border-radius: 10px;
  background: rgba(255,255,255,0.8);
  font-size: 15px;
  outline: none;
  transition: all 0.3s ease;
}
input:focus {
  background: white;
  box-shadow: 0 0 10px rgba(255,215,0,0.4);
}

button {
  width: 100%;
  padding: 12px;
  border: none;
  border-radius: 10px;
  background: linear-gradient(90deg, #f7c948, #d4a017);
  color: white;
  font-size: 16px;
  cursor: pointer;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}
button:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 15px rgba(255,215,0,0.4);
}

#recaptcha-container { margin-top: 10px; }

.note {
  font-size: 13px;
  color: #3f3f3f;
  margin-top: 10px;
  opacity: 0.8;
}
</style>
</head>
<body>

<div class="login-container">
  <div class="logo">
    <img src="kc.png" alt="Keshava Jewellers Logo">
  </div>
  <h2>Employee Login</h2>

  <input type="text" id="phoneNumber" placeholder="+91XXXXXXXXXX" maxlength="13">
  <div id="recaptcha-container"></div>
  <button id="getOtpBtn">Get OTP</button>

  <input type="text" id="otp" placeholder="Enter OTP" style="display:none;">
  <button id="verifyOtpBtn" style="display:none;">Verify OTP</button>

  <p class="note">Authorized access for Keshava Jewellers staff only.</p>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>

<script>
// ✅ Your Firebase Config
const firebaseConfig = {
  apiKey: "AIzaSyDu5HrS1C-sL1mvTIpQ8Z_29l46SgmXugM",
  authDomain: "getestimation-e0978.firebaseapp.com",
  projectId: "getestimation-e0978",
  storageBucket: "getestimation-e0978.firebasestorage.app",
  messagingSenderId: "305257891317",
  appId: "1:305257891317:web:5b20c8e5121d0fbb9a0cbc",
  measurementId: "G-21C5H9BRQ7"
};


firebase.initializeApp(firebaseConfig);

// ✅ Allowed Employee Numbers
const allowedEmployees = {
  "+917975073574": "Sudhamsha",
  "+918861609330": "Samarth"
};

// ✅ Initialize Recaptcha
window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier('recaptcha-container', {
  'size': 'normal'
});
recaptchaVerifier.render();

// ✅ Send OTP
document.getElementById("getOtpBtn").addEventListener("click", () => {
  const phone = document.getElementById("phoneNumber").value.trim();

  if (!allowedEmployees[phone]) {
    alert("❌ Your mobile number is not registered. Please contact the employer.");
    return;
  }

  const appVerifier = window.recaptchaVerifier;
  firebase.auth().signInWithPhoneNumber(phone, appVerifier)
    .then((confirmationResult) => {
      window.confirmationResult = confirmationResult;
      alert("✅ OTP sent to " + phone);
      document.getElementById("otp").style.display = "block";
      document.getElementById("verifyOtpBtn").style.display = "block";
      document.getElementById("getOtpBtn").style.display = "none";
    })
    .catch((error) => {
      alert("Error sending OTP. Try again later.");
      console.error(error);
    });
});

// ✅ Verify OTP
document.getElementById("verifyOtpBtn").addEventListener("click", () => {
  const otpCode = document.getElementById("otp").value.trim();
  window.confirmationResult.confirm(otpCode)
    .then((result) => {
      const phone = result.user.phoneNumber;
      const employeeName = allowedEmployees[phone];
      alert(`Welcome ${employeeName}!`);
      sessionStorage.setItem("employeeName", employeeName);
      window.location.href = "estimation.html";
    })
    .catch((error) => {
      alert("Invalid OTP. Please try again.");
      console.error(error);
    });
});
</script>

</body>
</html>
